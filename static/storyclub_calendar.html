<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storytelling Events</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        h1 {
            color: #333;
            text-align: center;
        }

        .about {
            margin-top: 15px;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        button.active {
            background-color: #2e7d32;
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.3);
        }

        .date-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        input[type="date"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: all 0.3s;
        }

        input[type="date"]:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        input[type="date"].active {
            border-color: #2e7d32;
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.3);
        }

        .events-list {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .event {
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border-left: 4px solid #4CAF50;
            border-radius: 4px;
        }

        .event.special {
            background: linear-gradient(135deg, #43a047 0%, #66bb6a 100%);
            border: 2px solid #2e7d32;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        }

        .event-name {
            font-weight: bold;
            color: #333;
            font-size: 16px;
        }

        .event.special .event-name {
            color: #ffffff;
        }

        .event-date {
            color: #666;
            margin-top: 5px;
        }

        .event.special .event-date {
            color: #e8f5e9;
        }

        .event-location {
            color: #888;
            font-style: italic;
            margin-top: 3px;
            font-size: 14px;
        }

        .event.special .event-location {
            color: #c8e6c9;
        }

        .event-facebook {
            display: inline-block;
            margin-left: 10px;
            text-decoration: none !important;
            vertical-align: middle;
            border: none;
            border-bottom: none !important;
        }

        .event-facebook svg {
            width: 20px;
            height: 20px;
            fill: #1877f2;
            transition: fill 0.3s;
        }

        .event-facebook:hover svg {
            fill: #145dbf;
        }

        .event-name a {
            color: #333;
            text-decoration: none;
            border-bottom: 2px solid #4CAF50;
        }

        .event.special .event-name a {
            color: #ffffff !important;
            border-bottom: 2px solid #ffeb3b !important;
        }

        .event-name a:hover {
            border-bottom-color: #45a049;
        }

        .event.special .event-name a:hover {
            border-bottom-color: #fff59d !important;
        }

        .no-events {
            text-align: center;
            color: #999;
            padding: 20px;
        }
    </style>
</head>

<body>
    <h1>Storytelling Events Calendar</h1>

    <div class="controls">
        <div class="button-group">
            <button id="thisWeekBtn" onclick="showThisWeek()">This Week</button>
            <button id="nextWeekBtn" onclick="showNextWeek()">Next Week</button>
        </div>
        <div class="date-inputs">
            <label>From:</label>
            <input type="date" id="startDate" onchange="handleDateChange()">
            <label>To:</label>
            <input type="date" id="endDate" onchange="handleDateChange()">
            <button id="showBtn" onclick="showDateRange()">Show Events</button>
        </div>
    </div>

    <div class="events-list" id="eventsList"></div>

    <div class="about" id="colophon"><em>Hacked together by Tony Hirst in conversation with Claude.ai, inspired by <a href="https://www.facebook.com/groups/societyforstorytelling/posts/10172947366465461/">a list</a> of storytelling club dates posted by Peter Giles to the Society for Storytelling Facebook group on Saturday, November 29th, 2025.</em></div>

    <script>
        const troupes_and_promoters = [
            {name:"'Tis Tales", link: "https://tisltales.org.uk", location:"Isle of Wight", facebook:"https://www.facebook.com/tistales"},
            { name: "", link: "", location: "Ropetackle Arts Centre, Shoreham-by-Sea", facebook: "https://www.facebook.com/RopetackleStorytellers" },
            ];

        const events = [
            { name: "Sheffield Story Forge", schedule: "3rd tuesday", location: "", link: "", facebook: "https://www.facebook.com/groups/94064587663", club:"sheffieldstoryforge"},
            { name: "Matlock storytelling circle", schedule: "last wednesday", location: "", link: "", facebook: "https://www.facebook.com/MatlockStorytellingCafe", club:"matlockSC"},
            { name: "Leicester Story Tree", schedule: "1st tuesday", location: "", link: "http://leicesterstorytelling.com", facebook: "https://www.facebook.com/profile.php?id=100086273211826" , email: "leicesterstorytelling@gmail.com", club:"leicesterstorytree"},
            { name: "Exeter Story Club", schedule: "2nd wednesday", location: "The Cowick Barton, Exeter", link: "", facebook: "https://www.facebook.com/ExeterStoryClub", club:"exeterSC" },
            { name: "Birmingham Storytelling Cafe", schedule: "3rd wednesday", location: "", link: "", facebook: "https://www.facebook.com/groups/BirminghamStorytellingcafe", club:"birminghamSCafe" },
            { name: "Gloucester Storytelling Cafe", schedule: "1st thursday", location: "", link: "", facebook: "https://www.facebook.com/profile.php?id=61554490450596", club: "gloucesterSCafe" },
            { name: "Beeston Tales", schedule: "3rd wednesday", location: "", link: "", facebook: "https://www.facebook.com/groups/beestontales", club: "beestontales", tickets_url: "https://www.tickettailor.com/events/beestontales/" },
            { name: "Matlock Storytelling Cafe", schedule: "1st friday", location: "Imperial Rooms, Imperial Road, Matlock", link: "", facebook: "https://www.facebook.com/MatlockStorytellingCafe", club:"matlockSCafe", tickets_url: "https://www.tickettailor.com/events/matlockstorytellingcafe/"},
            { name: "Hebden Bridge Shaggydog storytellers", schedule: "last friday", location: "", link: "", facebook: "https://www.facebook.com/TheShaggyDogStorytellers" , club:"shaggydogstorytellers"},
            { name: "Huddersfield story circle", schedule: "2nd monday", location: "Rat and Ratchet pub, Huddersfield", link: "", facebook: "", club: "huddersfieldSCi" },
            { name: "Haworth storytelling circle", schedule: "1st thursday", location: "", link: "", facebook: "https://www.facebook.com/HaworthStorytellingCircle", club:"HaworthStorytellingCircle" },
            { name: "Chester Triple Spiral", schedule: "1st tuesday", location: "", link: "", facebook: "https://www.facebook.com/groups/1432324863552369", club:"chestertriplespiral" },
            { name: "Cambridge Storytellers", schedule: "2nd sunday", location: "", link: "https://www.cambridgestorytellers.com/", facebook: "https://www.facebook.com/CambridgeStorytellers", club:"cambridgestorytellers" },
            { name: "Mendip Story Circle", schedule: "2nd wednesday", location: "", link: "https://www.mendipstorycircle.com/", facebook: "https://www.facebook.com/profile.php?id=100064070403986", club:"mendipsSCi" },
            { name: "Glasgow Better Crack Storytelling Club", schedule: "3rd Friday", location: "", link: "", facebook: "https://www.facebook.com/groups/115339998550789", club: "glasgowbettercrack" },
            { name: "Glasgow EVEN Better Crack Storytelling Club (Children)", schedule: "3rd saturday", location: "", link: "", facebook: "", club: "glasgowevenbettercrack" },
            { name: "Island Storytellers, Isle of Wight", schedule: "2nd thursday", time: "7-9pm", location: "Various locations", link: "https://tistales.org.uk/island-storytellers/", facebook: "https://www.facebook.com/groups/islandstorytellers" , club:"islandstorytellers"},
            { name: "Surrey: Three Heads In A Well storytelling circle", schedule: "4th friday", location: "", link: "https://www.surreystorytellers.co.uk", facebook: "https://www.facebook.com/groups/366190587003",  club:"threeheadsinawell" },
            { name: "Bletchley: Tales Tattled and Told", schedule: "3rd saturday", location: "Rectory Cottages, Bletchley", link: "", facebook: "https://www.facebook.com/lynettehilluk", club:"talestattledtold" },
            { name: "Northampton: Feast of Fools", schedule: "1st wednesday", location: "Quaker Meeting House, Northampton", time: "7-9.30pm", link: "https://www.storyfeast.uk/", facebook: "https://www.facebook.com/StorytellingFeast", club:"feastoffools" },
            { name: "South Devon storytellers (Totnes)", schedule: "3rd wednesday", location: "", link: "https://www.sdstorytellers.co.uk/", facebook: "https://www.facebook.com/profile.php?id=61560384152751", email:"southdevonstorytellers@gmail.com", club:"southdevonstorytellers" },
            { name: "Plymouth Storytelling Circle", schedule: "4th sunday", location: "Snapdragons, Victoria Park, Plymouth", link: "", facebook: "https://www.facebook.com/profile.php?id=61580047292990", club:"plymouthSCi" },
            { name: "The Plough Storytelling Circle (North Devon)", schedule: "1st thursday", location: "St Anne's Arts & Community Centre in Barnstaple", link: "https://www.theploughartscentre.org.uk/", facebook: "https://www.facebook.com/ploughstorytelling", email:"storytelling.plough@gmail.com", club:"ploughSCi" },
            { name: "Liskeard Storytelling Cafe", schedule: "4th thursday", location: "", link: "", facebook: "https://www.facebook.com/groups/488666447814753" , club:"liskeardSCa"},
            { name: "Lichfield storytellers", schedule: "1st tuesday", location: "", link: "", facebook: "https://www.facebook.com/lichfieldstorytellers", email:"lichfieldstorytellers@gmail.com", club: "lichfieldST" },
            { name: "Wirral Quirky Tales", schedule: "2nd tuesday", location: "Making Space, West Kirby", link: "", facebook: "https://www.facebook.com/profile.php?id=100086449665967", club:"quirkytales" },
            { name: "Guesthouse storytellers, Newhaven", schedule: "2nd tuesday", location: "", link: "", facebook: "https://www.facebook.com/groups/guesthousestorytellers", club:"guesthouseST", tickets_url: "https://www.tickettailor.com/events/xanthegreshamknightguesthousethegoddesslounge" },
            { name: "Southampton Story Club", schedule: "1st thursday", location: "Guide Dog Pub, Southampton", time: "8-10pm", link: "", facebook: "https://www.facebook.com/groups/southamptonstories", club:"southamptonSC" },
            { name: "Sarum Story club", schedule: "3rd tuesday", location: "", link: "", facebook: "https://www.facebook.com/groups/sarumstoryclub", club:"sarumSC"},
            { name: "Bristol Wild Wednesday storytelling", schedule: "3rd wednesday", location: "", link: "", facebook: "https://www.facebook.com/groups/412446392168295", club:"bristolwildwednesday" },
            { name: "Dartmoor Storytellers", schedule: "2nd wednesday", location: "Chagford Inn, Chagford", link: "", facebook: "https://www.facebook.com/groups/1689129511376075", club:"dartmoorSTorytellers" },
            { name: "A Bit Crack Storytelling", schedule: "1st friday", location: "Newcaste", link: "", facebook: "https://www.facebook.com/ABitCrack" , club:"abitcrack"},
            { name: "Cardiff Story circle", schedule: "1st sunday", location: "", link: "", facebook:"https://www.facebook.com/groups/1491740927748170/", club:"cardiffSC" },
            { name: "Mendip story circle", schedule: "2nd wednesday", location: "Ston Easton Village Hall, Radstock", link: "https://www.mendipstorycircle.com/", facebook: "https://www.facebook.com/profile.php?id=100064070403986", club: "" },
            { name: "Frome storytelling circle", schedule: "last monday", location: "Three Swans pub, Frome", link: "", facebook: "https://www.facebook.com/laralavender6", club: "fromeSC" },
            { name: "Brighton Telltales", schedule: "1st wednesday", location: "The Yellow Book", link: "", facebook: "https://www.facebook.com/brightontelltales", club: "brightontelltales",club_flyer:"brighton_telltales_flyer.jpg" },
            { name: "Leek storytellers", schedule: "2nd wednesday", location: "The Fountain Inn, Leek (subj. to change)", link: "", facebook: "https://www.facebook.com/leekstorytellers", email:"Fernandfables@gmail.com", club:"leekstorytellers", club_flyer: "leekstorytellers_flyer.jpg" },
            { name: "Sale", schedule: "4th monday", location: "Brook pub, Brooklands - Phil", link: "https://www.thebrooksale.co.uk/", facebook: "" },
            { name: "Much Wenlock, Salop - words at the edge", schedule: "2nd monday", location: "", link: "", facebook: "https://www.facebook.com/groups/wordsattheedge", club: "wordsattheedge" },
            { name: "Manchester - Sting in the Tale", schedule: "3rd wednesday", location: "", link: "", facebook: "https://www.facebook.com/astinginthetaleclub", email:"astinginthetaleclub@gmail.com", club:"stinginthetale"},
            { name: "Aberystwyth Fables Stroytelling Circle", schedule: "", location: "", link: "", facebook: "https://www.facebook.com/groups/aberfables", club: "aberystwythfables" },
            { name: "Winchester Wykeham Tales [Lapsed?]", schedule: "2nd wednesday", location: "", link: "", facebook: "" },
            // TO DO : add online attribute, default "false", other: "true", "hybrid"; in price, square brackets is online price
            // TO DO - lots more legacy stinginthetale
        ];

        const specificEvents = [
            { name: "Winter Tales", date: "10/12/2025", location: "Carvel Lane Coffee House", link: "", isSpecial: true },
            { name: "Protest Days, Rebellion Nights: songs and stories of the Luddites — Monty + The AnyWhens", date: "04/12/2025", location: "October Books, Southampton", link: "https://octoberbooks.lemonbooking.com/events/116/details", isSpecial: true },
            { name: "Kukolka [Ronnie Conboy]", showname: "Kulkolka", performer: "Ronnie Conboy", date: "17/12/25", club: "stinginthetale" , price: "£8 / £6", description: "Kukolka is a weaving of traditional Slavic wondertales with 20th century wartime narrative. At the heart of it all, the wisdom of Baba Yaga questions what choices are made, when all good choices are gone.", location: "Lock 91 Bar, Manchester" , venue_url: "https://www.manchesterbars.com/lock91.htm", event_flyer:"2025_12_17STinginthetale_conboy.jpg",  isSpecial: true },
            { name: "A Figure of Speech [Daniel Morden]", showname: "A Figure of Speech", performer: "Daniel Morden", date: "15/10/25", time:"7pm", club: "stinginthetale", price: "£8 / £6", description: "Come and hear stories of ridiculous and sometimes horrific bodies; these funny and macabre stories are the perfect way to celebrate a spooky month!", location: "Lock 91 Bar, Manchester", venue_url: "https://www.manchesterbars.com/lock91.htm", event_flyer: "2025_10_15STinginthetale_morden.jpg",  isSpecial: true },
            { name: "Beyond the Glass Mountain [Cath Little & Bronia Evers]", showname: "Beyond the Glass Mountain", performer: "Cath Little | Bronia Evers", date: "22/11/2025", time: "", club: "", price: "£10", description: "", location: "Chapter Arts, Cardiff", venue_url: "https://www.chapter.org/", event_flyer: "2025_11_22_independent_little_evans.jpg", isSpecial: true },
            { name: "The Mighty Goddess [Sally Pomme Clayton]", showname: "The Mighty Goddess", performer: "Sally Pomme Clayton", date: "04/12/2025", time: "7pm", club: "abitcrack", price: "£10 / £5 / £3", description: "The Goddess is coming.... Enter the pine forest. Meet: Creator; Mother; Lover; Virgin; Crone. Bring a burning question and get an answer from the goddess's oracle! Be prepared for X_rated stories! Adults only.", location: "Alphabetti Theatre, Newcastle", venue_url: "https://www.alphabettitheatre.co.uk/", event_flyer: "2025_12_04_abitcrack_pomme_goddess.jpg", isSpecial: true },
            { name: "Warm Hearted Christmas Stories [Cath Edwards & Matt Vaughan]", showname: "Warm Hearted Christmas Stories", performer: "Cath Edwards | Matt Vaughan", date: "09/12/2025", time: "7.30pm", club: "leicesterstorytree", price: "£5 (£3)", description: "", location: "Central Library, Leicester", venue_url: "https://bookfinder.leicester.gov.uk/whats-on#/?tag=Storytelling", fb_event: 1201185658550299 , isSpecial: true },
            { name: "Finding Light in the Dark [Trevor Valentine tells 'The Firefly Man']", showname: "The Firefly Man", performer: "Trevor Valentine", date: "", time: "", club: "gloucesterSCafe", price: "", description: "", location: "The Folk of Gloucester", venue_url: "", event_flyer: "2025_12_04_gloucesterSCafe_valentine_findinglight.jpg", openslots: true , isSpecial: true },
            { name: "At Winters Heart (Solstice Storytelling) [Henry Moore & Hannah Sneyd]", showname: "At Winters Heart (Solstice Storytelling", performer: "Henry Moore | Hannah Sneyd", date: "14/12/2025", time: "6pm", club: "", price: "", description: "Dartmoor-based storytellers Henry Everett and Hannah Sneyd promise a rich evening of tales crafted especially for the Solstice. Blending traditional stories from around the world with original tales inspired by the land and the deepening shadows of the season, we will gather together to bring light, joy, and depth to this midwinter moment.", location: "Moor Imagination Collective, Buckfastleigh", venue_url: "https://www.moorimagination.org/", event_flyer: "2025_12_14_independent_everett_wintersheart.jpg", fb_event: 781568461574252, ticket_url: "https://app.workshop-angel.com/form.php?h=1&t=0&e=ce0a6d05c12a5e06", isSpecial: true },
             { name: "At Winters Heart (Solstice Storytelling) [Henry Moore & Hannah Sneyd]", showname: "At Winters Heart (Solstice Storytelling", performer: "Henry Moore | Hannah Sneyd", date: "19/12/2025", time: "6pm", club: "", price: "", description: "Dartmoor-based storytellers Henry Everett and Hannah Sneyd promise a rich evening of tales crafted especially for the Solstice. Blending traditional stories from around the world with original tales inspired by the land and the deepening shadows of the season, we will gather together to bring light, joy, and depth to this midwinter moment.", location: "The Circle Barn, Beden, Sampford Spiney", venue_url: "https://www.moorimagination.org/", event_flyer: "2025_12_14_independent_everett_wintersheart.jpg", fb_event: 781568461574252, ticket_url: "https://app.workshop-angel.com/form.php?h=1&t=0&e=fc633890fdf6d24b", isSpecial: true },
              { name: "The Hairy Girl [Kersti Stabi]", showname: "The Hairy Girl", performer: "Kersti Stabi", date: "09/12/2025", time: "7.30pm", club: "guesthouseST", price: "£12/£10/£8", description: "", location: "Hillcrest Community Centre, Newhaven", venue_url: "", event_flyer: "genericSTabi_hairygirl.jpg", isSpecial: true, ticket_url: "https://www.tickettailor.com/events/xanthegreshamknightguesthousethegoddesslounge/1779452", isSpecial: true },
            { name: "Uncanny [Nell Phoenix]", showname: "The Hairy Girl", performer: "Nell Phoenix", date: "11/11/2025", time: "7.30pm", club: "guesthouseST", price: "£12/£10/£8", description: "", location: "Hillcrest Community Centre, Newhaven", venue_url: "", event_flyer: "g2025_11_11_guesthouseST_phoenix_uncanny.jpg", isSpecial: true, ticket_url: "", isSpecial: true },
            { name: "A Dance with the Minotaur's Sister [Steph Brittain]", showname: "A Dance with the Minotaur’s Sister", performer: "Steph Brittain", date: "17/12/2025", time: "7.30-10pm", club: "beestontales", price: "£8 [£6.50]", description: "Join storyteller Steph Brittain as she follows Ariadne’s journey as it unravels through the maze of love, betrayal, loss, joy and the bulls and the bees. Before the thread and before the tangled and twisted maze, there was Ariadne full of life and rhythm. From a dance floor in the forest and the labyrinth's twisting and tangled passages to the starry skies of the Island of Naxos, Steph Brittain weaves an intricate tapestry of love, strength and courage.", location: "Our Lady of the Assumption Church Hall, Beeston, Nottingham", venue_url: "", event_flyer: "", ticket_url: "https://www.tickettailor.com/events/beestontales/1955497" , isSpecial: true },
            { name: "The Stealing of the Sun and Moon [Nick Hennessey]", showname: "The Stealing of the Sun and Moon", performer: "Nick Hennessey", date: "21/02/2026", time: "7.30-10pm", club: "beestontales", price: "£8 [£6.50]", description: "oin Nick for a performance that journeys into the deep, snow-filled forests of the Finnish far north, where the river of the underworld flows dark and fast, and the summer sun shines just a little too bright. In this world created from shards of eggshell, the sun and moon are fought over, magic is done and undone, and life is shot through with bizarre ordeals, misguided passions, magical battles and transformations. Expect a remarkable performance of elemental epic.", location: "Our Lady of the Assumption Church Hall, Beeston, Nottingham", venue_url: "", event_flyer: "", ticket_url: "https://www.tickettailor.com/events/beestontales/1955498", online: "hybrid", isSpecial: true },
            { name: "The Goddess of Spreadsheets [Tim Ralphs]", showname: "The Goddess of Spreadsheets", performer: "Tim Ralphs", date: "05/12/2025", time: "7.30-10pm", club: "matlockSCafe", price: "£8 [£6.50]", description: "A position has just opened in our More-than-Human Resources Department! As the heroic head of the hiring committee for the divine pantheon, it's up to you to put together a team of sacred scribes, astral accountants and celestial problem-solvers. Tim has got the candidates for you to consider. With the right team of Godly governors in place, this incorporeal corporation is going places.", fb_event: 3200801733411778, location: "Imperial Rooms, Matlock", venue_url: "", event_flyer: "", ticket_url: "https://www.tickettailor.com/events/matlockstorytellingcafe/1922225", online: "hybrid", isSpecial: true  },
            { name: "Fen, Folk and Fable", showname: "Fen, Folk and Fable", performer: "", date: "25/11/2025", time: "6-7pm", club: "cambridgestorytellers", price: "free", description: "", location: "Newnham Social Club, Cambridge", venue_url: "", event_flyer: "2025_11_25_cambridgestorytellers_fenfolkfable.jpg", ticket_url: "", isSpecial: true },
            { name: "Arnside Sailing Club — Storyteller [Nick Hennessey]", showname: "Arnside Sailing Club — Storyteller", performer: "Nick Hennessey", date: "21/12/2025", time: "3.30-5.00pm", club: "other", price: "£12 / £10 / £8", description: "On the Sunday before Christmas, an afternoon show with Nick Hennessey, an internationally acclaimed storyteller, playwright, folk singer, song writer, harpist and musician.  He has performed at venues such as the South Bank, Barbican, Royal Albert Hall and festivals worldwide, He has broadcast on Radio 4 and his music played on Radio 3. Nick has a particular interest in the story telling tradition of Finland. He will take you to the snow filled forests of the Far North, the darkness of the winter night and the warmth of the winter fire, travelling by song, story and music.", location: "The Old Customs House, Arnside, Carnforth", venue_url: "", event_flyer: "", ticket_url: "https://www.tickettailor.com/events/arnsidesailingclub/1967155" , isSpecial: true },
            { name: "The Dead of Winter [Merl Fluin & Holly Medland]", showname: "", performer: "Merl Fluin | Holly Medland", date: "The Dead of Winter", time: "7-9.30pm", club: "", price: "£10", description: "Step in from the cold and enjoy the fine tradition of ghost stories for the festive season. Storytellers Merl Fluin and Holly Medland will take you on a journey to the places where wraiths walk at night. \n The cafe will be open from 6: 30pm, serving hot food, drinks and delicious cakes to help keep the chill at bay. Storytelling starts at 7:15pm.", location: "Better Days Cafe, Ventnor", venue_url: "https://thebetterdayscafe.co.uk/", event_flyer: "2025_12_16_medlandfluin_deadofwinter.jpg", ticket_url: "https://www.ticketsource.com/storytelling/the-dead-of-winter-chilling-tales-for-the-festive-season/e-kjbezy", isSpecial: true }
            
            
            // { name: "", showname: "", performer: "", date: "", time:"", club: "", price: "", description: "", location: "", venue_url: "", event_flyer: "", ticket_url:"", isSpecial: true }
        ];

        const podcasts = [
            {series_title:"Taking the Tradition On", presenter: "Amy Douglas", schedule:"", url: "https://www.youtube.com/channel/UCpcvx1G7TUAbeZU80cJJX8ghttps://www.youtube.com/@TakingTheTraditionOn"}
            //  {series_title: "", presenter: "", schedule:"", url: ""}
        ]

        const courses = [
            {title: "24 Story Seeds", leader: "Sally Pomme Clayton", date:"06/12/2025", location:"Summerhill Bowling Club, Newcastle-upon-Tyne", cost:"£40", link:"https://www.facebook.com/ABitCrack", club: "abitcrack", course_flyer: "2025_12_06_abitcrack_pomme_24storyseeds.jpg"},
        ];

        // Events with incomplete information (no specific schedule):
        // - Storytellers of Nottingham (monthly wednesday/thursday - varies)
        // - Dundee blethertaygither (2nd last Thursday)
        // - Shoreham Ropetackle storytellers (no schedule provided)
        // - Aberdeen Grampian Association of storytellers (no schedule provided)
        // - New Forest Storytellers Ringwood (no schedule provided)
        // - Bishops Castle BLAST (no schedule provided)

        function getWeekStart(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1);
            return new Date(d.setDate(diff));
        }

        function getWeekEnd(weekStart) {
            const end = new Date(weekStart);
            end.setDate(end.getDate() + 6);
            return end;
        }

        function parseSchedule(schedule, startDate, endDate) {
            const results = [];

            // Check if it's a specific date in DD/MM/YYYY format
            if (schedule.includes('/')) {
                const [day, month, year] = schedule.split('/').map(num => parseInt(num, 10));
                const specificDate = new Date(year, month - 1, day);
                if (specificDate >= startDate && specificDate <= endDate) {
                    results.push(specificDate);
                }
                return results;
            }

            const [occurrence, dayName] = schedule.toLowerCase().split(/\s+/);
            const dayMap = { sunday: 0, monday: 1, tuesday: 2, wednesday: 3, thursday: 4, friday: 5, saturday: 6 };
            const targetDay = dayMap[dayName];

            const current = new Date(startDate);
            const end = new Date(endDate);

            while (current <= end) {
                const year = current.getFullYear();
                const month = current.getMonth();

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);

                let eventDate = null;

                if (occurrence === 'last') {
                    for (let d = lastDay.getDate(); d >= 1; d--) {
                        const testDate = new Date(year, month, d);
                        if (testDate.getDay() === targetDay) {
                            eventDate = testDate;
                            break;
                        }
                    }
                } else {
                    const occurrenceNum = occurrence === '1st' ? 1 : occurrence === '2nd' ? 2 : occurrence === '3rd' ? 3 : 4;
                    let count = 0;
                    for (let d = 1; d <= lastDay.getDate(); d++) {
                        const testDate = new Date(year, month, d);
                        if (testDate.getDay() === targetDay) {
                            count++;
                            if (count === occurrenceNum) {
                                eventDate = testDate;
                                break;
                            }
                        }
                    }
                }

                if (eventDate && eventDate >= startDate && eventDate <= endDate) {
                    results.push(eventDate);
                }

                current.setMonth(current.getMonth() + 1);
            }

            return results;
        }

        function displayEvents(startDate, endDate) {
            const eventsList = document.getElementById('eventsList');
            const allEvents = [];

            events.forEach(event => {
                const dates = parseSchedule(event.schedule, startDate, endDate);
                dates.forEach(date => {
                    allEvents.push({
                        name: event.name,
                        date: date,
                        schedule: event.schedule,
                        location: event.location || null,
                        link: event.link,
                        facebook: event.facebook || null,
                        isSpecial: false
                    });
                });
            });

            specificEvents.forEach(event => {
                const [day, month, year] = event.date.split('/').map(num => parseInt(num, 10));
                const eventDate = new Date(year, month - 1, day);
                if (eventDate >= startDate && eventDate <= endDate) {
                    allEvents.push({
                        name: event.name,
                        date: eventDate,
                        schedule: null,
                        location: event.location,
                        link: event.link,
                        facebook: event.facebook || null,
                        isSpecial: event.isSpecial || false
                    });
                }
            });

            allEvents.sort((a, b) => a.date - b.date);

            const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

            if (allEvents.length === 0) {
                eventsList.innerHTML = '<div class="no-events">No events in this period</div>';
                return;
            }


            // Create header text
            const startStr = `${startDate.getDate()} ${months[startDate.getMonth()]} ${startDate.getFullYear()}`;
            const endStr = `${endDate.getDate()} ${months[endDate.getMonth()]} ${endDate.getFullYear()}`;
            const headerText = startStr === endStr
                ? `<em>Showing clubs and events for the week of <strong>${startStr}</strong>.</em>`
                : `<em>Showing clubs and events for the week of <strong>${startStr} - ${endStr}</strong>.</em>`;

            eventsList.innerHTML = `<div style="margin-bottom: 15px; color: #333;">${headerText}</div><hr/>` + allEvents.map(event => {
                const dayName = daysOfWeek[event.date.getDay()];
                const day = event.date.getDate();
                const month = months[event.date.getMonth()];
                const year = event.date.getFullYear();

                const scheduleText = event.schedule ? ` (${event.schedule})` : '';
                const locationText = event.location ? `<div class="event-location">${event.location}</div>` : '';

                const eventName = event.link
                    ? `<a href="${event.link}" target="_blank">${event.name}</a>`
                    : event.name;

                // Add Facebook link if available
                let facebookLink = '';
                if (event.facebook && event.facebook.trim()) {
                    const fbUrl = event.facebook.startsWith('http')
                        ? event.facebook
                        : `https://facebook.com/${event.facebook}`;
                    facebookLink = `<a href="${fbUrl}" target="_blank" class="event-facebook" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>`;
                }

                const specialClass = event.isSpecial ? ' special' : '';

                return `
                    <div class="event${specialClass}">
                        <div class="event-name">${eventName}${facebookLink}</div>
                        ${locationText}
                        <div class="event-date">${dayName}, ${day} ${month} ${year}${scheduleText}</div>
                    </div>
                `;
            }).join('');
        }

        function setActiveMode(mode) {
            // Remove active class from all buttons and inputs
            document.getElementById('thisWeekBtn').classList.remove('active');
            document.getElementById('nextWeekBtn').classList.remove('active');
            document.getElementById('startDate').classList.remove('active');
            document.getElementById('endDate').classList.remove('active');

            // Add active class based on mode
            if (mode === 'thisWeek') {
                document.getElementById('thisWeekBtn').classList.add('active');
            } else if (mode === 'nextWeek') {
                document.getElementById('nextWeekBtn').classList.add('active');
            } else if (mode === 'dateRange') {
                document.getElementById('startDate').classList.add('active');
                if (document.getElementById('endDate').value) {
                    document.getElementById('endDate').classList.add('active');
                }
            }
        }

        function handleDateChange() {
            const startInput = document.getElementById('startDate').value;
            const endInput = document.getElementById('endDate').value;

            if (!startInput) return;

            let startDate = new Date(startInput);
            let endDate = endInput ? new Date(endInput) : null;

            // If end date is before start date, set end date to start date
            if (endDate && endDate < startDate) {
                document.getElementById('endDate').value = startInput;
                endDate = new Date(startInput);
            }

            // Auto-update when dates are set
            if (startInput) {
                setActiveMode('dateRange');
                showDateRange();
            }
        }

        function showThisWeek() {
            const today = new Date();
            const weekStart = getWeekStart(today);
            const weekEnd = getWeekEnd(weekStart);
            displayEvents(weekStart, weekEnd);
        }

        function showNextWeek() {
            const today = new Date();
            const thisWeekStart = getWeekStart(today);
            const nextWeekStart = new Date(thisWeekStart);
            nextWeekStart.setDate(nextWeekStart.getDate() + 7);
            const nextWeekEnd = getWeekEnd(nextWeekStart);
            displayEvents(nextWeekStart, nextWeekEnd);
        }

        function showDateRange() {
            const startInput = document.getElementById('startDate').value;
            const endInput = document.getElementById('endDate').value;

            if (!startInput) {
                alert('Please select at least a start date');
                return;
            }

            let startDate = new Date(startInput);
            let endDate;

            if (!endInput) {
                // If only start date provided, show that week
                const weekStart = getWeekStart(startDate);
                const weekEnd = getWeekEnd(weekStart);
                displayEvents(weekStart, weekEnd);
            } else {
                endDate = new Date(endInput);

                if (startDate > endDate) {
                    alert('Start date must be before end date');
                    return;
                }

                displayEvents(startDate, endDate);
            }
        }

        showThisWeek();
    </script>
</body>

</html>